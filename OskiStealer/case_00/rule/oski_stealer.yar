import "hash"


rule OskiStealer_s
{
    meta:
		author = "Celal Dogan Duran"
		description = "OskiStealer"
    strings:
        $str1 = "oski.myz.info"
        $str2= "056139954853430408"
       	$str3 = "\\Microsoft\\Edge\\User Data\\" 
        $str4 = "outlook.txt"
        $str5= "Password"
        $str6 = "KrIQo17IFiGtq1e9nw=="
        $str7 = "GZIxlBOHQTb+y2KIrtYSkaTI/pHkUM8sMbgYvU0="
		$sql1 = "CZYvlWrzRC2x9lfpy4VB/KOcyp/eeYwgNLtW7FZ9oinPwE8mGXO+oUQ9oIuPTmY//FYp6Fk/jtbG33g/9AmyJJTtkm82k33qs3jfLl0="
		$sql2= "CZYvlWrzRCqs7ESshbNHxrvEmqXDcIdidaZSx0gw7jXZvwo1DXKo+gsqvKSQXXNmuRgO13NejszI1GQ0pw=="
		$sql3= "CZYvlWrzRA2R1neaoKlrmPeByY/YYYF8e6Vb4RJx8iHI+wZlBXKE/gE7rYmDED87uUA47E523f/Sx2515X/QW+n9zylh/S+z6CeCcx5wd5JwYcnj8E1jIXAdaf+hK7Oz19EyNRysSNA0qIZ8vwm0ByNx118="
		$sql4 = "CZYvlWrzRCu/6EaahIJt17aa3vyQcI18fblW7Fc+7B/R/EQxBC376BwosYmHSHZ8smcx4F1hgoDE0n8+iyGVBruojV8pon33pWPCLkpoAfATDIfh700raGEsaeyqP7Q="
		$sql5 = "CZYvlWrzRCO34E+hhY1f0fvIzLHcYJAsUpl41R487Trj9UU3AWmy/hA3qoI="
		$sql6="CZYvlWrzRCu/6Ebpy5pT2KKNmpbiWrgsdb5D91g47iw="
		$chr1 = "Bo8vv0rGCGWN8UKxjg=="
		$chr2 = "FrwEuUeHICSq5A=="
		$chr3 = "GbwMu0DCFw=="
		$chr4 = "DbYB8G3GECQ="
		$fire1 = "ObwMu0DCF2ut9E+sn4k="
		$fire2="NrwEuUfUSi+t6k0="
		$fire3= "PLwRvUHOFzGx91rrmJ1e3aON"
    condition:
        all of them or 
		hash.md5(0,filesize) == "c98eba0c6b6491eaf7a05618cab679b9" or
		3 of ($sql*) and 2 of ($chr*) and any of ($fire*) or
		4 of ($str*) and 3 of ($sql*) 
} 





rule OskiStealer_d
{
    meta:
		author = "Celal Dogan Duran"
		description = "OskiStealer"
    strings:
		$str1 = "1BEF0A57BE110FD467A"
		$str2 = "system.txt"
		$str3 = "password.txt"
		$str4 = "outlook.txt"
		$str5 = "crypto"
		$str6 = "cc"
		$str7 ="cookies"
		$str8 = "autofill"
		$o1 = "Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging Subsystem\\Profiles\\Outlook\\9375CFF0413111d3B88A00104B2A6676"
		$o2 = "Software\\Microsoft\\Windows Messaging Subsystem\\Profiles"
		$r1 = "RegOpenKeyExA"
		$r2 = "RegEnumValueA"
		$f1 = "Web Data"
		$f2 = "Cookies"
		$f3 = "Login Data"
		$f4 = "Local State"
		$f5= "logins.json"
		$f6 = "cookies.sqlite"
		$f7 = "formhistory.sqlite"
		$c1 = "Bitcoin"
		$c2 = "Ethereum"
		$c3 ="Electrum"
		$c4 = "Exodus"
		$c5 = "MultiDoge"
		$c6 = "LiteCoin"
	condition: 
		all of them or
		hash.md5(0,filesize) == "c98eba0c6b6491eaf7a05618cab679b9" or
		4 of ($str*) and 3 of ($c*) or
		4 of ($str*) and 3 of ($f*) or
		2 of ($str*) and all of ($r*) and all of ($o*) 
} 
