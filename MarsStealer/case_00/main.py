import sys
def readWord(file):
    byte = file.read(1)
    if not byte:
        return True,None
    buffer = []
    #if byte is null then pass null bytes
    while byte == b'\x00':
        byte = file.read(1)
        if not byte:
            return True,None
    #if byte is not null then read to buffer
    while byte != b'\x00':
        buffer.append(byte)
        byte = file.read(1)
    return False,buffer

def readKey(file,size):
    byte = file.read(1)
    if not byte:
        return True,None
    buffer = []
    #if byte is null then pass null bytes
    while byte == b'\x00':
        byte = file.read(1)
        if not byte:
            return True,None
    #if byte is not null then read to buffer for size times
    for i in range(size):
        buffer.append(byte)
        byte = file.read(1)
    
    return False,buffer
def get_data_list(filename):
    keyList = []
    dataList = []
    with open(filename, "rb") as file:
        while True:
            #Read Data from file
            eofD ,data = readWord(file=file)
            #Read Key from file
            if eofD:
                break
            eofK ,key = readKey(file=file,size=len(data))
            if eofK:
                break
            if data == None or key == None:
                continue
            keyList.append(key)
            dataList.append(data)
    return keyList,dataList
def xor(data, key):
    try:
        return True, bytes(ord(a) ^ ord(b) for a, b in zip(data, key)).decode("utf-8").rstrip('\n').split('\\n')[0]
    except:
        return False,None
        
if __name__ == "__main__":
    path = sys.argv[1]
    keyList,dataList = get_data_list(path)
    for data,key in zip(dataList,keyList):
        isUtf8 ,result = xor(data,key)
        if isUtf8:
            print(result)

